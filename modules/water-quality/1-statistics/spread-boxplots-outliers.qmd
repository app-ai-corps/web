---
title: "Measures of Spread, Spotting Outliers"
crossref:
  lst-title: "üéØ Checkpoint"
format: live-html
sidebar: lesson-1
---

A second and final statistical measure we'll discuss today is **spread**. Just as it sounds, measures of spread tell us how spread out our data are. Spread, also referred to as **variability**, is *the backbone* of statistics!

**To-Do:** We need to re-load the class csv data since the webpage doesn't save things from page-to-page. Please paste the csv link again in the block below and run it.

```{pyodide}
#| include: false
import requests
import csv
from io import StringIO

def load_class_data(csv_url):
    response = requests.get(csv_url)
    reader = csv.reader(StringIO(response.text))
    next(reader)  # Skip header
    rows = list(reader)
    
    class_nitrate = [int(row[3]) for row in rows]
    class_nitrite = [int(row[4]) for row in rows]
    
    return class_nitrate, class_nitrite
```

```{pyodide}
#| persist: true
#| completion: false
# Replace the url with the one provided from your teacher. 
# Make sure to keep the quotation marks!

csv_url = "www.replace_this_with_your_csv_url.csv"

class_nitrate, class_nitrite = load_class_data(csv_url)

print("Nitrate values:", class_nitrate)
print("Nitrite values:", class_nitrite)
```

## Two Measures of Spread
Today, we'll discuss two measures of spread: the **range** and the **standard deviation**.

### Range
The **range** is a fairly simple calculation. It's the biggest number minus the smallest number. Or, put differently, the maximum minus the minimum in a dataset.

:::{.ltorange-container}
**max()** - **min()**
:::

Here is an example of finding the range using our sample dataset:
```{pyodide}
#| edit: false
sample_data = [1, 2, 6, 5, 1]

sample_range = max(sample_data) - min(sample_data)

print("Range of sample data:", sample_range)
```

**YOUR TURN:** Find the range of the class nitrate and class nitrate data! Fill in the `???` with the appropriate object name and run the block.
```{pyodide}
#| persist: true
#| completion: false
class_nitrate_range = max(???) - min(???)
class_nitrite_range = max(???) - min(???)

print("Range of class nitrate data:", class_nitrate_range)
print("Range of class nitrite data:", class_nitrite_range)
```

### Standard Deviation

The standard deviation tells us how spread out the numbers are from the mean. Put diffently, it tells us the average distance the data in the dataset is from the mean. The formula looks a bit technical:

:::{.ltorange-container}
$\Large \sqrt{\frac{\sum (x - \bar{x})^2}{n}}$
:::

Here is an example of calculating the standard deviation using our sample dataset:

```{pyodide}
#| edit: false
import numpy as np

sample_data = [1, 2, 6, 5, 1]

sample_stdev = np.std(sample_data)

print("Standard Deviation of sample data:", sample_stdev)
```

**YOUR TURN:** Find the standard deviation of the class nitrate and class nitrite data! Fill in the `???` with the appropriate object name and run the block.
```{pyodide}
#| persist: true
#| completion: false
class_nitrate_stdev = np.std(???)
class_nitrite_stdev = np.std(???)

print("Standard Deviation of class nitrate data:", class_nitrate_stdev)
print("Standard Deviation of class nitrite data:", class_nitrite_stdev)
```

## What Could Cause High Variability?

If a creek's reading has high standard deviation (lots of variability in comparison to other creeks), it might mean:

1. **Pollution events** - A factory dumps waste occasionally
2. **Storm runoff** - Rain washes fertilizer from farms into the creek
3. **Natural cycles** - Some creeks naturally vary
4. **Sensor problems** - The equipment might need calibration
5. **Different sampling times** - Morning vs afternoon can be different

It might also signal that your data has one or more ***outliers***.

## Outliers

### What Are Outliers?

**Outliers** are data points that are very different from the rest of your data. They're the "weird" numbers that don't fit the pattern. Outliers can really change your statistics‚Äîlike mean and standard deviation.

```{pyodide}
#| edit: false
sample_data = [1, 2, 6, 5, 1]

sample_woutlier = [1, 2, 6, 5, 1, 15]
```

That 15 is an outlier! It's way higher than everything else.

### Why Do Outliers Happen?

Outliers can happen for different reasons:

 1. **Sensor Malfunction** üîß
- The sensor glitched or needs calibration
- Battery was dying
- Sensor got knocked around

 2. **Real Pollution Event** üö®
- Factory dumped chemicals into the stream
- Farm fertilizer washed in after a storm
- Sewage spill

 3. **Natural Event** üåßÔ∏è
- Heavy rain changed water chemistry
- Algae bloom
- Seasonal variation

**Your job as a scientist:** Figure out which reason it is!

## Boxplots

We can also use a **boxplot** to visualize outliers automatically! It's like a detective tool for finding weird data. Here is a boxplot of our sample data with the outlier added:

```{pyodide}
#| completion: false
import matplotlib.pyplot as plt

plt.figure(figsize=(10, 6))
plt.boxplot(sample_woutlier, vert=True, patch_artist=True, 
            boxprops=dict(facecolor='lightblue'),
            medianprops=dict(color='red', linewidth=2))
plt.title('Boxplot: Outliers Shown as Circles', fontsize=14)
plt.grid(True, alpha=0.3, axis='y')
plt.ylim(0, 17)
plt.xticks([])

plt.text(1.15, 15, '‚Üê High outlier', fontsize=11, va='center')
plt.text(1.15, np.median(sample_woutlier), f'‚Üê Median ({np.median(sample_woutlier)})', fontsize=11, va='center')
plt.show()

print("The circle shows the outlier!")
print("The box shows where most of the other data is.")
```

**Reading a box plot:**  
- The **line in the middle** = Median  
- The **box** = Where the middle 50% of data is  
- The **whiskers** (lines extending out) = Normal range  
- The **circles** = Outliers!  



### Class Nitrate Boxplot
**Your Turn:** Create a Boxplot for the Class Nitrate Data

```{pyodide}
#| completion: false
plt.figure(figsize=(8, 6))
plt.boxplot(class_nitrate, vert=True, patch_artist=True,
            boxprops=dict(facecolor='plum'))
plt.ylabel('Nitrate (mg/L)', fontsize=12)
plt.xticks([])
plt.title('Boxplot of Class Nitrate', fontsize=13)
plt.grid(True, alpha=0.3, axis='y')
plt.show()
```

### Class Nitrite Boxplot
**Your Turn:** Create a Boxplot for the Class Nitrite Data

```{pyodide}
#| completion: false
plt.figure(figsize=(8, 6))
plt.boxplot(class_nitrite, vert=True, patch_artist=True,
            boxprops=dict(facecolor='lemonchiffon'))
plt.ylabel('Nitrite (mg/L)', fontsize=12)
plt.xticks([])
plt.title('Boxplot of Class Nitrite', fontsize=13)
plt.grid(True, alpha=0.3, axis='y')
plt.show()
```

:::{.callout-important}
## Do either have outliers? How do you know?
:::

### Takeaways When Encountering an Outlier

When you find an outlier, investigate it:

1. **Is it possible?** (nitrate concentration of 100 mg/L = unlikely)
2. **What happened that day?** (Check notes, weather, etc.)
3. **Does it fit a pattern?** (One spike vs multiple high readings)
4. **Is the sensor/buoy/test strip working?** (Check calibration, battery)
