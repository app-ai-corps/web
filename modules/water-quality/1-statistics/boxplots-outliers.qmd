---
title: "Boxplots and Outliers"
crossref:
  lst-title: "üéØ Checkpoint"
format: live-html
sidebar: lesson-1
---

:::{.ltblue-container}
**Checkpoints on this Page:**

- [**Checkpoint 1:** Import Class Data](#lst-getcsv)
- [**Checkpoint 2:** Find Ranges of Class Data](#lst-classdatarange)
- [**Checkpoint 3:** Find Standard Deviations of Class Data](#lst-classdatastddev)
- [**Checkpoint 4:** Create Boxplot for Sample Data](#lst-sampledataboxplot)
- [**Checkpoint 5:** Create Boxplot for Class Nitrate Data](#lst-classnitrateboxplot)
- [**Checkpoint 5:** Create Boxplot for Class Nitrite Data](#lst-classnitriteboxplot)
:::
<hr>

:::{#lst-getcsv}

**To-Do:** We need to re-load the class csv data since the webpage doesn't save variables from page-to-page. Please paste the csv link again in the block below and run it.

```{pyodide}
#| include: false
import requests
import csv
from io import StringIO

def load_class_data(csv_url):
    response = requests.get(csv_url)
    reader = csv.reader(StringIO(response.text))
    next(reader)  # Skip header
    rows = list(reader)
    
    class_nitrate = [int(row[3]) for row in rows]
    class_nitrite = [int(row[4]) for row in rows]
    
    return class_nitrate, class_nitrite
```

```{pyodide}
#| persist: true
#| completion: false
# Replace the url with the one provided from your teacher. 
# Make sure to keep the quotation marks!

csv_url = "www.replace_this_with_your_csv_url.csv"

class_nitrate, class_nitrite = load_class_data(csv_url)

print("Nitrate values:", class_nitrate)
print("Nitrite values:", class_nitrite)
```

Once more, import your whole class's nitrate and nitrite data.
:::

## Visualizing the Data: Boxplots!

A key practice in statistics is to visualize the data! One of the types of plots we can use to do this is a **boxplot**, sometimes referred to as a box and whisker plot. A boxplot requires that we order the data (as if calculating a median) and then then divide the data into four equal groups (by number of observations), called **quartiles**.

### Activity: Boxplots By Hand
:::{.callout-note}
## *Data Recorder (Sticky Notes)*
Grab those sticky notes from the nitrates lab! Sort them by sticky color and pass them out to each group, matching the sticky color to the group's tent color. This will result in each group having a full set of stickies for both class nitrate and nitrite data.
:::

1. After your groups has received all of its stickies, create two stacks‚Äîone for nitrate and one for nitrite (you can distinguish them by the writing color). 

2. Next, order your nitrate stickies from least to greatest, in a line across the table/desk. Then, do the same for your nitrite stickies. When finished, you should have two separate rows of stickies.

![](images/ordered_nitrate_nitrite_stickies.png)

3. Find the median (middle number) for both the nitrates and nitrites data (that is, both rows of stickies).

![](images/ordered_nitrate_nitrite_stickies_medians.png)

4. At your desk, you will find a large sheet of gridded Post-It paper. The top of the paper has an axis drawn for the nitrate boxplot and the bottom of the paper has an axis drawn for the nitrite boxplot. *Draw the median line for the nitrate boxplot and the nitrite boxplot.* The median line will form the center of the boxplot.

4. 

## Outliers

### What Are Outliers?

**Outliers** are data points that are very different from the rest of your data. They're the "weird" numbers that don't fit the pattern. Outliers can really change your statistics‚Äîlike mean and standard deviation.

```{pyodide}
#| edit: false
sample_data = [1, 2, 6, 5, 1]

sample_woutlier = [1, 2, 6, 5, 1, 15]
```

That 15 is an outlier! It's way higher than everything else.

### Why Do Outliers Happen?

Outliers can happen for different reasons:

 1. **Sensor Malfunction** üîß
- The sensor glitched or needs calibration
- Battery was dying
- Sensor got knocked around

 2. **Real Pollution Event** üö®
- Factory dumped chemicals into the stream
- Farm fertilizer washed in after a storm
- Sewage spill

 3. **Natural Event** üåßÔ∏è
- Heavy rain changed water chemistry
- Algae bloom
- Seasonal variation

**Your job as a scientist:** Figure out which reason it is!

## Boxplots

We can also use a **boxplot** to visualize outliers automatically! It's like a detective tool for finding weird data. Here is a boxplot of our sample data with the outlier added:

:::{#lst-sampledataboxplot}

```{pyodide}
#| completion: false
import matplotlib.pyplot as plt

plt.figure(figsize=(10, 6))
plt.boxplot(sample_woutlier, vert=True, patch_artist=True, 
            boxprops=dict(facecolor='lightblue'),
            medianprops=dict(color='red', linewidth=2))
plt.title('Boxplot: Outliers Shown as Circles', fontsize=14)
plt.grid(True, alpha=0.3, axis='y')
plt.ylim(0, 17)
plt.xticks([])

plt.text(1.15, 15, '‚Üê High outlier', fontsize=11, va='center')
plt.text(1.15, np.median(sample_woutlier), f'‚Üê Median ({np.median(sample_woutlier)})', fontsize=11, va='center')
plt.show()

print("The circle shows the outlier!")
print("The box shows where most of the other data is.")
```

Create a boxplot for the sample data with the outlier added.
:::

**Reading a box plot:**  
- The **line in the middle** = Median  
- The **box** = Where the middle 50% of data is  
- The **whiskers** (lines extending out) = Normal range  
- The **circles** = Outliers!  



### Class Nitrate Boxplot

:::{#lst-classnitrateboxplot}
**Your Turn:** Create a Boxplot for the Class Nitrate Data

```{pyodide}
#| completion: false
plt.figure(figsize=(8, 6))
plt.boxplot(class_nitrate, vert=True, patch_artist=True,
            boxprops=dict(facecolor='plum'))
plt.ylabel('Nitrate (mg/L)', fontsize=12)
plt.xticks([])
plt.title('Boxplot of Class Nitrate', fontsize=13)
plt.grid(True, alpha=0.3, axis='y')
plt.show()
```

Create a boxplot for the class nitrate data.
:::

### Class Nitrite Boxplot

:::{#lst-classnitriteboxplot}
**Your Turn:** Create a Boxplot for the Class Nitrite Data

```{pyodide}
#| completion: false
plt.figure(figsize=(8, 6))
plt.boxplot(class_nitrite, vert=True, patch_artist=True,
            boxprops=dict(facecolor='lemonchiffon'))
plt.ylabel('Nitrite (mg/L)', fontsize=12)
plt.xticks([])
plt.title('Boxplot of Class Nitrite', fontsize=13)
plt.grid(True, alpha=0.3, axis='y')
plt.show()
```

Create a boxplot for the class nitrite data.
:::

:::{.callout-important}
## Does either have outliers? How do you know?
:::

## Adding Means to Boxplots
Write the code here

:::{.callout-caution}
## Question!
What do you notice about the relationship between the mean and median for the nitrate data? Why do you think that might be?
:::

